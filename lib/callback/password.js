'use strict';

var prompt = require('../prompt'),
    validate = require('../validate'),
    messages = require('../messages');

var validatePassword = validate.validatePassword,
    invalidPasswordMessage = messages.invalidPasswordMessage;


function passwordCallback(next, done, context) {
  var description = 'Password: ',
      validationFunction = validatePassword,
      errorMessage = invalidPasswordMessage,
      attempts = 3,
      hidden = true,
      options = {
    description: description,
    validationFunction: validationFunction,
    errorMessage: errorMessage,
    attempts: attempts,
    hidden: hidden
  };

  prompt(options, function (password) {
    var valid = password !== null;

    if (valid) {
      Object.assign(context, {
        password: password
      });

      next();
    } else {
      done();
    }
  });
}

module.exports = passwordCallback;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9jYWxsYmFjay9wYXNzd29yZC5qcyJdLCJuYW1lcyI6WyJwcm9tcHQiLCJyZXF1aXJlIiwidmFsaWRhdGUiLCJtZXNzYWdlcyIsInZhbGlkYXRlUGFzc3dvcmQiLCJpbnZhbGlkUGFzc3dvcmRNZXNzYWdlIiwicGFzc3dvcmRDYWxsYmFjayIsIm5leHQiLCJkb25lIiwiY29udGV4dCIsImRlc2NyaXB0aW9uIiwidmFsaWRhdGlvbkZ1bmN0aW9uIiwiZXJyb3JNZXNzYWdlIiwiYXR0ZW1wdHMiLCJoaWRkZW4iLCJvcHRpb25zIiwicGFzc3dvcmQiLCJ2YWxpZCIsIk9iamVjdCIsImFzc2lnbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLElBQU1BLFNBQVNDLFFBQVEsV0FBUixDQUFmO0FBQUEsSUFDTUMsV0FBV0QsUUFBUSxhQUFSLENBRGpCO0FBQUEsSUFFTUUsV0FBV0YsUUFBUSxhQUFSLENBRmpCOztBQUlNLElBQUVHLGdCQUFGLEdBQXVCRixRQUF2QixDQUFFRSxnQkFBRjtBQUFBLElBQ0VDLHNCQURGLEdBQzZCRixRQUQ3QixDQUNFRSxzQkFERjs7O0FBR04sU0FBU0MsZ0JBQVQsQ0FBMEJDLElBQTFCLEVBQWdDQyxJQUFoQyxFQUFzQ0MsT0FBdEMsRUFBK0M7QUFDN0MsTUFBTUMsY0FBYyxZQUFwQjtBQUFBLE1BQ01DLHFCQUFxQlAsZ0JBRDNCO0FBQUEsTUFFTVEsZUFBZVAsc0JBRnJCO0FBQUEsTUFHTVEsV0FBVyxDQUhqQjtBQUFBLE1BSU1DLFNBQVMsSUFKZjtBQUFBLE1BS01DLFVBQVU7QUFDUkwsaUJBQWFBLFdBREw7QUFFUkMsd0JBQW9CQSxrQkFGWjtBQUdSQyxrQkFBY0EsWUFITjtBQUlSQyxjQUFVQSxRQUpGO0FBS1JDLFlBQVFBO0FBTEEsR0FMaEI7O0FBYUFkLFNBQU9lLE9BQVAsRUFBZ0IsVUFBU0MsUUFBVCxFQUFtQjtBQUNqQyxRQUFNQyxRQUFTRCxhQUFhLElBQTVCOztBQUVBLFFBQUlDLEtBQUosRUFBVztBQUNUQyxhQUFPQyxNQUFQLENBQWNWLE9BQWQsRUFBdUI7QUFDckJPLGtCQUFVQTtBQURXLE9BQXZCOztBQUlBVDtBQUNELEtBTkQsTUFNTztBQUNMQztBQUNEO0FBQ0YsR0FaRDtBQWFEOztBQUVEWSxPQUFPQyxPQUFQLEdBQWlCZixnQkFBakIiLCJmaWxlIjoicGFzc3dvcmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IHByb21wdCA9IHJlcXVpcmUoJy4uL3Byb21wdCcpLFxuICAgICAgdmFsaWRhdGUgPSByZXF1aXJlKCcuLi92YWxpZGF0ZScpLFxuICAgICAgbWVzc2FnZXMgPSByZXF1aXJlKCcuLi9tZXNzYWdlcycpO1xuXG5jb25zdCB7IHZhbGlkYXRlUGFzc3dvcmQgfSA9IHZhbGlkYXRlLFxuICAgICAgeyBpbnZhbGlkUGFzc3dvcmRNZXNzYWdlIH0gPSBtZXNzYWdlcztcblxuZnVuY3Rpb24gcGFzc3dvcmRDYWxsYmFjayhuZXh0LCBkb25lLCBjb250ZXh0KSB7XG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gJ1Bhc3N3b3JkOiAnLFxuICAgICAgICB2YWxpZGF0aW9uRnVuY3Rpb24gPSB2YWxpZGF0ZVBhc3N3b3JkLCAgICAgICAgXG4gICAgICAgIGVycm9yTWVzc2FnZSA9IGludmFsaWRQYXNzd29yZE1lc3NhZ2UsXG4gICAgICAgIGF0dGVtcHRzID0gMyxcbiAgICAgICAgaGlkZGVuID0gdHJ1ZSxcbiAgICAgICAgb3B0aW9ucyA9IHtcbiAgICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgICAgdmFsaWRhdGlvbkZ1bmN0aW9uOiB2YWxpZGF0aW9uRnVuY3Rpb24sXG4gICAgICAgICAgZXJyb3JNZXNzYWdlOiBlcnJvck1lc3NhZ2UsXG4gICAgICAgICAgYXR0ZW1wdHM6IGF0dGVtcHRzLFxuICAgICAgICAgIGhpZGRlbjogaGlkZGVuXG4gICAgICAgIH07XG5cbiAgcHJvbXB0KG9wdGlvbnMsIGZ1bmN0aW9uKHBhc3N3b3JkKSB7XG4gICAgY29uc3QgdmFsaWQgPSAocGFzc3dvcmQgIT09IG51bGwpO1xuXG4gICAgaWYgKHZhbGlkKSB7XG4gICAgICBPYmplY3QuYXNzaWduKGNvbnRleHQsIHtcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICB9KTtcblxuICAgICAgbmV4dCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb25lKCk7XG4gICAgfVxuICB9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBwYXNzd29yZENhbGxiYWNrOyJdfQ==