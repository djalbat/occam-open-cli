'use strict';

var prompt = require('../prompt'),
    validate = require('../validate'),
    messages = require('../messages');

var validateUsername = validate.validateUsername,
    invalidUsernameMessage = messages.invalidUsernameMessage;


function usernameCallback(next, done, context) {
  var username = context.username;


  if (username !== null) {
    var valid = validateUsername(username);

    if (valid) {
      next();
    }
  }

  var description = 'Username: ',
      validationFunction = validateUsername,
      errorMessage = invalidUsernameMessage,
      attempts = 3,
      hidden = false,
      options = {
    description: description,
    validationFunction: validationFunction,
    errorMessage: errorMessage,
    attempts: attempts,
    hidden: hidden
  };

  prompt(options, function (username) {
    var valid = username !== null;

    if (valid) {
      Object.assign(context, {
        username: username
      });

      next();
    } else {
      done();
    }
  });
}

module.exports = usernameCallback;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2VzNi9jYWxsYmFjay91c2VybmFtZS5qcyJdLCJuYW1lcyI6WyJwcm9tcHQiLCJyZXF1aXJlIiwidmFsaWRhdGUiLCJtZXNzYWdlcyIsInZhbGlkYXRlVXNlcm5hbWUiLCJpbnZhbGlkVXNlcm5hbWVNZXNzYWdlIiwidXNlcm5hbWVDYWxsYmFjayIsIm5leHQiLCJkb25lIiwiY29udGV4dCIsInVzZXJuYW1lIiwidmFsaWQiLCJkZXNjcmlwdGlvbiIsInZhbGlkYXRpb25GdW5jdGlvbiIsImVycm9yTWVzc2FnZSIsImF0dGVtcHRzIiwiaGlkZGVuIiwib3B0aW9ucyIsIk9iamVjdCIsImFzc2lnbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLElBQU1BLFNBQVNDLFFBQVEsV0FBUixDQUFmO0FBQUEsSUFDTUMsV0FBV0QsUUFBUSxhQUFSLENBRGpCO0FBQUEsSUFFTUUsV0FBV0YsUUFBUSxhQUFSLENBRmpCOztBQUlNLElBQUVHLGdCQUFGLEdBQXVCRixRQUF2QixDQUFFRSxnQkFBRjtBQUFBLElBQ0VDLHNCQURGLEdBQzZCRixRQUQ3QixDQUNFRSxzQkFERjs7O0FBR04sU0FBU0MsZ0JBQVQsQ0FBMEJDLElBQTFCLEVBQWdDQyxJQUFoQyxFQUFzQ0MsT0FBdEMsRUFBK0M7QUFBQSxNQUNyQ0MsUUFEcUMsR0FDeEJELE9BRHdCLENBQ3JDQyxRQURxQzs7O0FBRzdDLE1BQUlBLGFBQWEsSUFBakIsRUFBdUI7QUFDckIsUUFBTUMsUUFBUVAsaUJBQWlCTSxRQUFqQixDQUFkOztBQUVBLFFBQUlDLEtBQUosRUFBVztBQUNUSjtBQUNEO0FBQ0Y7O0FBRUQsTUFBTUssY0FBYyxZQUFwQjtBQUFBLE1BQ01DLHFCQUFxQlQsZ0JBRDNCO0FBQUEsTUFFTVUsZUFBZVQsc0JBRnJCO0FBQUEsTUFHTVUsV0FBVyxDQUhqQjtBQUFBLE1BSU1DLFNBQVMsS0FKZjtBQUFBLE1BS01DLFVBQVU7QUFDUkwsaUJBQWFBLFdBREw7QUFFUkMsd0JBQW9CQSxrQkFGWjtBQUdSQyxrQkFBY0EsWUFITjtBQUlSQyxjQUFVQSxRQUpGO0FBS1JDLFlBQVFBO0FBTEEsR0FMaEI7O0FBYUFoQixTQUFPaUIsT0FBUCxFQUFnQixVQUFTUCxRQUFULEVBQW1CO0FBQ2pDLFFBQU1DLFFBQVNELGFBQWEsSUFBNUI7O0FBRUEsUUFBSUMsS0FBSixFQUFXO0FBQ1RPLGFBQU9DLE1BQVAsQ0FBY1YsT0FBZCxFQUF1QjtBQUNyQkMsa0JBQVVBO0FBRFcsT0FBdkI7O0FBSUFIO0FBQ0QsS0FORCxNQU1PO0FBQ0xDO0FBQ0Q7QUFDRixHQVpEO0FBYUQ7O0FBRURZLE9BQU9DLE9BQVAsR0FBaUJmLGdCQUFqQiIsImZpbGUiOiJ1c2VybmFtZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgcHJvbXB0ID0gcmVxdWlyZSgnLi4vcHJvbXB0JyksXG4gICAgICB2YWxpZGF0ZSA9IHJlcXVpcmUoJy4uL3ZhbGlkYXRlJyksXG4gICAgICBtZXNzYWdlcyA9IHJlcXVpcmUoJy4uL21lc3NhZ2VzJyk7XG5cbmNvbnN0IHsgdmFsaWRhdGVVc2VybmFtZSB9ID0gdmFsaWRhdGUsXG4gICAgICB7IGludmFsaWRVc2VybmFtZU1lc3NhZ2UgfSA9IG1lc3NhZ2VzO1xuXG5mdW5jdGlvbiB1c2VybmFtZUNhbGxiYWNrKG5leHQsIGRvbmUsIGNvbnRleHQpIHtcbiAgY29uc3QgeyB1c2VybmFtZSB9ID0gY29udGV4dDtcblxuICBpZiAodXNlcm5hbWUgIT09IG51bGwpIHtcbiAgICBjb25zdCB2YWxpZCA9IHZhbGlkYXRlVXNlcm5hbWUodXNlcm5hbWUpO1xuXG4gICAgaWYgKHZhbGlkKSB7XG4gICAgICBuZXh0KCk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgZGVzY3JpcHRpb24gPSAnVXNlcm5hbWU6ICcsXG4gICAgICAgIHZhbGlkYXRpb25GdW5jdGlvbiA9IHZhbGlkYXRlVXNlcm5hbWUsXG4gICAgICAgIGVycm9yTWVzc2FnZSA9IGludmFsaWRVc2VybmFtZU1lc3NhZ2UsXG4gICAgICAgIGF0dGVtcHRzID0gMyxcbiAgICAgICAgaGlkZGVuID0gZmFsc2UsXG4gICAgICAgIG9wdGlvbnMgPSB7XG4gICAgICAgICAgZGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgICAgICAgIHZhbGlkYXRpb25GdW5jdGlvbjogdmFsaWRhdGlvbkZ1bmN0aW9uLFxuICAgICAgICAgIGVycm9yTWVzc2FnZTogZXJyb3JNZXNzYWdlLFxuICAgICAgICAgIGF0dGVtcHRzOiBhdHRlbXB0cyxcbiAgICAgICAgICBoaWRkZW46IGhpZGRlblxuICAgICAgICB9O1xuXG4gIHByb21wdChvcHRpb25zLCBmdW5jdGlvbih1c2VybmFtZSkge1xuICAgIGNvbnN0IHZhbGlkID0gKHVzZXJuYW1lICE9PSBudWxsKTtcblxuICAgIGlmICh2YWxpZCkge1xuICAgICAgT2JqZWN0LmFzc2lnbihjb250ZXh0LCB7XG4gICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZVxuICAgICAgfSk7XG5cbiAgICAgIG5leHQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZG9uZSgpO1xuICAgIH1cbiAgfSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gdXNlcm5hbWVDYWxsYmFjazsiXX0=